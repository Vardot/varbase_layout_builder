{#
/**
 * @file
 * Bootstrap Layouts: "4 Columns" template.
 *
 * Available layout variables:
 * - wrapper: Wrapper element for the layout container.
 * - attributes: Wrapper attributes for the layout container.
 *
 * Available region variables:
 * - first
 * - second
 * - third
 * - fourth
 *
 * Each region variable contains the following properties:
 * - wrapper: The HTML element to use to wrap this region.
 * - attributes: The HTML attributes to use on the wrapper for this region.
 * - content: The content to go inside the wrapper for this region.
 */
#}

{% set width_edge2edge = false %}
{% set has_vlb_background_color = false %}
{% set has_vlb_background_media = false %}

{% set section_attributes = create_attribute() %}
{% set section_attributes = section_attributes.addClass('vlb-section') %}

{% set container_attributes = create_attribute() %}
{% set container_attributes = container_attributes.addClass('container-fluid') %}

{% set outer_row_attributes = create_attribute() %}
{% set outer_row_attributes = outer_row_attributes.addClass('vlb-outer-row') %}
{% set outer_row_attributes = outer_row_attributes.addClass('row') %}

{% set inner_row_attributes = create_attribute() %}
{% set inner_row_attributes = inner_row_attributes.addClass('vlb-inner-row') %}
{% set inner_row_attributes = inner_row_attributes.addClass('row') %}

{# When the Width is Edge to Edge #}
{% if settings.vlb_section_config.vlb_width and settings.vlb_section_config.vlb_width == 'edge2edge' %}
  {% set width_edge2edge = true %}
  {% set section_attributes = section_attributes.addClass('bg-edge2edge') %}
  {% set container_attributes = container_attributes.addClass('container-fluid') %}
{% endif %}

{# When gutter option were selected. #}
{% if not (settings.vlb_section_config.vlb_gutter and settings.vlb_section_config.vlb_gutter == 1) %}
  {% set outer_row_attributes = outer_row_attributes.addClass('no-gutters') %}
  {% set inner_row_attributes = inner_row_attributes.addClass('no-gutters') %}
{% endif %}


{# Background media #}
{% if settings.vlb_section_config.vlb_background_media_html %}
  {% set has_vlb_background_media = true %}
  {% if settings.vlb_section_config.vlb_background_edge2edge and settings.vlb_section_config.vlb_background_edge2edge == 1 %}
    {% set width_edge2edge = true %}
    {% set section_attributes = section_attributes.addClass('bg-edge2edge') %}
    {% set section_attributes = section_attributes.addClass(settings.vlb_section_config.vlb_background_color) %}

    {% set container_attributes = container_attributes.removeClass('container-fluid').addClass('container') %}

    {% if settings.vlb_section_config.vlb_gutter and settings.vlb_section_config.vlb_gutter == 1 and settings.vlb_section_config.vlb_width and settings.vlb_section_config.vlb_width != 'edge2edge' %}
      {% set outer_row_attributes = outer_row_attributes.addClass('no-gutters') %}
    {% endif %}

  {% else %}

    {% if not (settings.vlb_section_config.vlb_gutter and settings.vlb_section_config.vlb_gutter == 1) %}
      {% if settings.vlb_section_config.vlb_width and settings.vlb_section_config.vlb_width == 'edge2edge' %}
        {% set container_attributes = container_attributes.removeClass('container-fluid').addClass('container') %}
      {% else %}
        {% set container_attributes = container_attributes.removeClass('container-fluid').removeClass('container') %}
      {% endif %}
    {% else %}
      {% set container_attributes = container_attributes.removeClass('container-fluid').addClass('container') %}
      {% if settings.vlb_section_config.vlb_width and settings.vlb_section_config.vlb_width == 'edge2edge' %}
       {% set outer_row_attributes = outer_row_attributes.addClass('no-gutters') %}
      {% endif %}
    {% endif %}


  {% endif %}
{% endif %}


{# Background color #}
{% if settings.vlb_section_config.vlb_background_color is not null and settings.vlb_section_config.vlb_background_color != '_none' %}
  {% set has_vlb_background_color = true %}
  {# When we do have Background colro we add edge to edge #}
  {% if settings.vlb_section_config.vlb_background_edge2edge and settings.vlb_section_config.vlb_background_edge2edge == 1 %}
    {% set width_edge2edge = true %}
    {% set section_attributes = section_attributes.addClass('bg-edge2edge') %}
    {% set section_attributes = section_attributes.addClass(settings.vlb_section_config.vlb_background_color) %}

    {% set container_attributes = container_attributes.removeClass('container-fluid').addClass('container') %}
    
    {% if settings.vlb_section_config.vlb_gutter and settings.vlb_section_config.vlb_gutter == 1 and settings.vlb_section_config.vlb_width and settings.vlb_section_config.vlb_width != 'edge2edge' %}
      {% set outer_row_attributes = outer_row_attributes.addClass('no-gutters') %}
    {% endif %}

  {% else %}

    {% if not (settings.vlb_section_config.vlb_gutter and settings.vlb_section_config.vlb_gutter == 1) %}
      {% if settings.vlb_section_config.vlb_width and settings.vlb_section_config.vlb_width == 'edge2edge' %}
        {% set container_attributes = container_attributes.removeClass('container-fluid').addClass('container') %}
      {% else %}
        {% set container_attributes = container_attributes.removeClass('container-fluid').removeClass('container') %}
      {% endif %}
    {% else %}
      {% set container_attributes = container_attributes.removeClass('container-fluid').addClass('container') %}
      {% if settings.vlb_section_config.vlb_width and settings.vlb_section_config.vlb_width == 'edge2edge' %}
       {% set outer_row_attributes = outer_row_attributes.addClass('no-gutters') %}
      {% endif %}
    {% endif %}

    {% if has_vlb_background_media %}
      {% set section_attributes = section_attributes.addClass(settings.vlb_section_config.vlb_background_color) %}
    {% else %}
      {% set outer_row_attributes = outer_row_attributes.addClass(settings.vlb_section_config.vlb_background_color) %}
    {% endif %}

  {% endif %}
{% endif %}

{# When the Width is Edge to Edit do not add the container #}
{% if settings.vlb_section_config.vlb_width_classes and settings.vlb_section_config.vlb_use_advanced != 1 %}
  {% set attributes = attributes.addClass(settings.vlb_section_config.vlb_width_classes) %}
{% endif %}

<div{{ section_attributes }}>

  {% if has_vlb_background_media %}
    {{ attach_library('varbase_layout_builder/background-media') }}
    <div class="vlb-background-media">
      {{ settings.vlb_section_config.vlb_background_media_html }}
    </div>
    <div class="vlb-content-wrapper">
  {% endif %}

        <div{{ container_attributes }}>
          <div{{ outer_row_attributes }}>
            <{{ wrapper }}{{ attributes }}>
              <div{{ inner_row_attributes }}>

                {{ title_suffix.contextual_links }}

                {% if first.content %}
                <{{ first.wrapper }}{{ first.attributes }}>
                  {{ first.content }}
                </{{ first.wrapper }}>
                {% endif %}

                {% if second.content %}
                <{{ second.wrapper }}{{ second.attributes }}>
                  {{ second.content }}
                </{{ second.wrapper }}>
                {% endif %}

                {% if third.content %}
                <{{ third.wrapper }}{{ third.attributes }}>
                  {{ third.content }}
                </{{ third.wrapper }}>
                {% endif %}

                {% if fourth.content %}
                <{{ fourth.wrapper }}{{ fourth.attributes }}>
                  {{ fourth.content }}
                </{{ fourth.wrapper }}>
                {% endif %}

              </div>
            </{{ wrapper }}>
          </div>
        </div>

  {% if has_vlb_background_media %}
    </div>
  {% endif %}

</div>
